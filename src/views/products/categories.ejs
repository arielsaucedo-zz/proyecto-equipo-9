<!DOCTYPE html>
<html lang="es">
<!-- Include Head -->
<%- include('../partials/head') %>

 <!-- Header -->
 <%- include('../partials/header') %>
 <!-- /Header -->

<body>
   <div class="container-fluid products-wrapper">
      <% if(products.length != 0){ %>
      <div class="row">
         <div class="col-12">
            <h1 class="products-title text-center"><%= title %></h1>
         </div>
      
      
      <hr>
      </div>
      <div class="product-detail">
         <div class="row">
            <div class="col-12 col-lg-3">
               <article class="product-detail-info">
                  <a href="/products/categories">
                     <h2 class="product-detail-title categories" style="font-size: 20px; cursor: pointer;" id="allProducts">
                        Todas las categorías
                        
                     </h2>
                     
                  </a>
                  <hr>
                  <% if (categories.length > 0) { %>
                     <% categories.forEach(category => { %>
                        <% if (category.products.length > 0) { %>
                           <a href="/products/categories/<%= category.name %>">
                              <h2 class="product-detail-title categories" style="font-size: 15px; cursor: pointer;" id="<%= category.name %>">
                                 <%= category.name %> 
                              </h2>
                           </a>
                           <hr>
                        <% } %>   
                     <% }) %>
                  <% } %>
               </article>
            </div>
            <div class="col-12 col-lg-9 row products-container pl-5">
 
               <% products.forEach(product => { %>

                  <div class="col-12 col-sm-6 col-lg-3">
                     <section class="product-box card">
                         <a href="/products/detail/<%= product.id %>">
                             <figure class="product-box_image">
                                 <img class="img-product" src="/images/products/<%= product.image %>" alt="imagen de producto">
                             </figure>
                             <article class="product-box_data bg-light text-center d-flex justify-content-center"> 
                                 <% if(product.discount > 0) { %>
                                     <div class="col-12 pl-0">
                                         <h2 class="original-price font-weight-light"><strike>$ <%= helpers.trunc(product.price) %> </strike></h2> <!-- Original Price -->
                                     </div>
                                 <% } else { %>
                                     <div id="sin-descuento" class="col-12 pl-0 ">
                                                 &nbsp;
                                     </div>
                                 <% } %> 
                                 <% if(product.discount > 0) { %>
                                     <span>
                                         <%= product.discount %> % OFF 
                                     </span>
                                 <% } %>
                                     <h2 class="ml-3">
                                         $<%= helpers.trunc((product.price - product.price * product.discount / 100).toFixed(2)) %>
                                     </h2>
                                     <p>
                                         <%= product.name %>
                                     </p>
                                     <i id="truck" class="fas fa-truck"></i>

                                     <form class="m-2" action="/users/<%= product.id %>/addToCart" method="POST" style="display: inline-flex">
                                         <div class="ml-1">
                                             <button type="submit" class="btn bg-cart"><i class="fas fa-cart-plus mr-2"></i> Agregar al carrito</button>
                                         </div>
                                     </form>
                             </article>
                         </a>
                     </section>
                 </div>
				<% }); %>
               
            </div>
         </div>
      </div>
      <% } else { %>
      <div class="col-12">
         <h2 class="products-title" style="padding: 100px 0; color: tomato;">Todavía no hay productos para catalogar.</h2>
         
      </div>
      <hr>
      <% } %>
   </div>

   <!-- footer -->
   <%- include('../partials/footer') %>
   <!-- /footer -->
</body>

</html>